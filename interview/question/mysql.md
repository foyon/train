Mysql相关面试题复盘

### ACID，如何保证？

* C： 一致性 由其他三个组合保证。

* A ：原子性  undo log,记录写入操作sql的逆sql，事物进行修改会写undo log,rollback 执行undo log 进行回滚。

* C：隔离性，利用锁和mvcc 多版本并发控制实现（乐观锁，被关锁，间隙锁）

* D：持久性， redo log，周期或者在事物提交的时候将内存段周期刷入磁盘。 sql query->buffer pool(内存) ->磁盘，fsync 通过子进程刷入磁盘，一旦宕机，从redo log中读取进行还原。

  binlog （二进制执行日志），binlog 在事物提交写入，其他2个日志是应用程序内部，写入时机相对较多。

  隔离级别4种（并发问题： 脏读、不可重复读、幻读）

  * 读未提交yyy

  * 不可重复读nyy
  * 可重复读（脏读是）

  * 串行化 nnn

  脏读： b读到a未提交的数据

  不可重复读： 两次读返回数据不一致

  幻读：读取2次发现返回行数不一致，主键上的问题

  ###   死锁

  #### mysql varchar（11） int（11）char（11） 区别？存储

  #### mysql int 自增倒5，删掉一条5，mysql 重启，insert 产出5， 自增id预存储在内存中，

### 聚集索引非聚集索引

SQL Sever索引类型有：唯一索引，主键索引，聚集索引，非聚集索引。

MySQL 索引类型有：唯一索引，主键（聚集）索引，非聚集索引，全文索引。

聚集索引有序，数据和索引在一起，检索速度快，插入更新相对慢，mysql 主键预生成。

非聚集索引是无序的

### B+树特性

矮胖的有序树，关键字（data）存于叶子上，有序，双向指针。

非叶子的关键字和子树指针树相同，左闭右开区间，非叶子节点存索引及子树指针（6B）。为所有叶子节点增加链指针。

与B树区别是 关键字和子树相同问题，B+查找必须到叶子才能查到。



如果用一个身份证号作为主键会有什么问题？

如果线上服务器CPU过高如何排查

mysql性能优化思路？

mysql 分表策略？

​	根据主键取余

​	Range

​	分区表

​	一致性hash策略

mysql业务使用量级？



